{"version":3,"sources":["codemirror.js","util.js","bread.js","dag.js","index.js"],"names":["DiffMatchPatch","require","dmp","global","JsDiff","CodeEditor","_this","this","el","ReactDOM","findDOMNode","querySelector","state","props","cm","CodeMirror","value","data","mode","matchBrackets","lineNumbers","keyMap","autoCloseBrackets","lineWrapping","undoDepth","viewportMargin","Infinity","tabSize","indentUnit","indentWithTabs","extraKeys","Cmd-Enter","CmdEnter","log","match","exec","Error","stack","line","parseInt","thing","document","createElement","className","innerText","JSON","stringify","mark","setBookmark","ch","widget","insertLeft","__lineText","getLine","__result","getAllMarks","filter","k","forEach","clear","eval","getValue","Cmd-Z","requestAnimationFrame","undo","Shift-Cmd-Z","redo","Cmd-K","fork","Cmd-S","save","Cmd-M","setMessage","on","origin","commit","text","selections","listSelections","map","indexFromPos","anchor","head","trim","find","updateDiff","focus","_this2","__diff","lineWidgets","eachLine","removeLineClass","compare","changes","diff_main","diff_cleanupSemantic","choffset","cmpoffset","_loop","_changes$j","Object","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","j","type","startpos","onclick","console","compareCommit","slice","length","posFromIndex","markText","replacedWith","_this3","curOp","setValue","setSelections","_ref","_ref2","err","react__WEBPACK_IMPORTED_MODULE_6___default","a","React","Component","reduce","prev","delta","version","__webpack_require__","d","__webpack_exports__","getChildren","getState","getPath","computeAnchor","getCurrentChunk","childStore","childMapping","store","id","parent","push","reduceFn","concat","children","bind","node","views","messages","sqr","x","dist2","v","w","y","distToSegment","p","Math","sqrt","l2","t","max","min","distToSegmentSquared","uuid","random","toString","Bread","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","dragThing","mouseMove","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_assertThisInitialized__WEBPACK_IMPORTED_MODULE_5__","mouseUp","e","setState","window","addEventListener","preventDefault","clientY","thingRect","rows","querySelectorAll","lines","i","rect","getBoundingClientRect","x0","left","x1","right","y0","top","y1","pos","bottom","slices","dist","clientX","closestPos","sort","b","split","join","dockTarget","layout","row","elements","nextRows","cloneLayout","oldThing","splice","newRow","updateLayout","removeEventListener","Slice","style","cursor","react_flip_move__WEBPACK_IMPORTED_MODULE_9__","rowi","key","react_addons_css_transition_group__WEBPACK_IMPORTED_MODULE_8___default","transitionName","transitionEnterTimeout","transitionLeaveTimeout","coli","assign","view","isDragging","getView","result","updateView","newRows","update","close","beginDrag","onClick","DAG","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","_util__WEBPACK_IMPORTED_MODULE_2__","textNode","createElementNS","svg","v_spacing","v_height","h_spacing","path","height","recursive","trail","rect_width","label","textContent","getComputedTextLength","rx","ry","width","includes","pointer","setPointer","metaKey","altKey","shiftKey","ctrlKey","trailIndex","indexOf","cx","cy","r","child","curvedHorizontal","x2","y2","mx","setAttribute","setAttributeNS","body","appendChild","pathIndex","chunk","updatePointer","shouldFork","applyUpdate","viewIndex","title","onMouseDown","hideFooter","ref","placeholder","disabled","onChange","target","onKeyDown","keyCode","toggleFocus","aria-hidden","_dag__WEBPACK_IMPORTED_MODULE_12__","_codemirror_js__WEBPACK_IMPORTED_MODULE_11__","Date","now","appendStore","date","DEFAULT_STATE","null","App","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_3__","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_4__","parse","localStorage","confirm","_bread_js__WEBPACK_IMPORTED_MODULE_10__","_Users_kevin_Dropbox_Projects_derp_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","message","render","getElementById"],"mappings":"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","file":"static/js/main.d458a2bd.chunk.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\n\n\nimport CodeMirror from 'codemirror';\nimport 'codemirror/mode/javascript/javascript'\nimport 'codemirror/lib/codemirror.css'\nimport 'codemirror/keymap/sublime'\n\nimport \"codemirror/addon/edit/closebrackets\"\nimport 'codemirror/addon/edit/matchbrackets'\nimport \"codemirror/addon/comment/comment\"\nimport \"./codemirror.css\"\n\nvar DiffMatchPatch = require('diff-match-patch');\nvar dmp = new DiffMatchPatch();\nglobal.dmp = dmp\n\nvar JsDiff = require('diff');\n\n\nexport default class CodeEditor extends React.Component {\n    componentDidMount(){\n        var el = ReactDOM.findDOMNode(this).querySelector('.editor');\n\n        var state = this.props.state;\n\n\n        var cm = CodeMirror(el, {\n            value: this.props.state.data,\n            mode: 'plain',\n\n            matchBrackets: true,\n            lineNumbers: false,\n            keyMap: 'sublime',\n            autoCloseBrackets: true,\n            lineWrapping: true,\n            undoDepth: 0,\n            viewportMargin: Infinity,\n            \n            tabSize: 4,\n            indentUnit: 4,\n            indentWithTabs: false,\n\n            extraKeys: {\n                \"Cmd-Enter\"(cm){\n                    cm.getAllMarks()\n                        .filter(k => k.__result)\n                        .forEach(k => k.clear());\n\n                    function log(value){\n                        var match = /\\<anonymous\\>:(\\d+)/.exec((new Error()).stack);\n                        if(match){\n                            var line = parseInt(match[1], 10)\n                            var thing = document.createElement('span')\n                            thing.className = 'result'\n                            thing.innerText = JSON.stringify(value)\n                            var mark = cm.setBookmark({ line: line - 1, ch: 1e8 }, {\n                                widget: thing,\n                                insertLeft: true\n                            })\n                            mark.__lineText = cm.getLine(line - 1)\n                            mark.__result = true;\n                        }\n                    }\n                    eval(cm.getValue())\n                },\n                \"Cmd-Z\": (cm) => requestAnimationFrame(k => this.props.undo()),\n                \"Shift-Cmd-Z\": (cm) => requestAnimationFrame(k => this.props.redo()),\n                \"Cmd-K\": (cm) => requestAnimationFrame(k => this.props.fork()),\n                \"Cmd-S\": (cm) => requestAnimationFrame(k => this.props.save()),\n                \"Cmd-M\": (cm) => {\n                    this.props.setMessage()\n                }\n            }\n        })\n        this.cm = cm;\n        \n        cm.on('change', (cm, ch) => {\n            if(ch.origin !== 'setValue' && cm.getValue() !== this.props.state.data){\n                // this.props.onChange(cm.getValue())\n                // console.log(cm.listSelections())\n                this.props.commit({ \n                    text: cm.getValue(),\n                    selections: cm.listSelections().map(k => [\n                        cm.indexFromPos(k.anchor),\n                        cm.indexFromPos(k.head),\n                    ])\n                })\n            }\n            cm.getAllMarks()\n                .filter(k => k.__result && k.__lineText.trim() !== cm.getLine(k.find().line).trim())\n                .forEach(k => k.clear());\n            // console.log(cm.getValue(), ch)\n            // this.props.onChange(cm.getValue())\n        })\n        this.updateDiff()\n    }\n    focus(){\n        this.cm.focus()\n    }\n    updateDiff(){\n\n        var cm = this.cm;\n        cm.getAllMarks()\n            .filter(k => k.__diff)\n            .forEach(k => k.clear());\n        if(cm.lineWidgets) cm.lineWidgets.forEach(k => k.clear());\n        cm.lineWidgets = []\n        cm.eachLine(line => {\n            cm.removeLineClass(line, 'background', 'line-inserted')\n            cm.removeLineClass(line, 'background', 'line-changed')\n        })\n\n        let compare = this.props.compare && this.props.compare.data\n\n        if(typeof compare === 'string'){\n\n            var changes = dmp.diff_main(compare, this.props.state.data);\n            dmp.diff_cleanupSemantic(changes)\n\n\n\n\n          // var a = dmp.diff_linesToChars_(compare, this.props.state.data);\n          // var lineText1 = a.chars1;\n          // var lineText2 = a.chars2;\n          // var lineArray = a.lineArray;\n          // var changes = dmp.diff_main(lineText1, lineText2, false);\n          // dmp.diff_charsToLines_(changes, lineArray);\n\n\n\n            var choffset = 0;\n            var cmpoffset = 0;\n\n            for(var j = 0; j < changes.length; j++){\n                let [type, text] = changes[j];\n                if(type < 0){ // delete\n                    let thing = document.createElement('span')\n                    thing.className = 'deleted'\n                    thing.innerText = text;\n                    let startpos = choffset;\n                    thing.onclick = () => {\n                        console.log('delete!', text)\n                        this.props.compareCommit({\n                            text: compare.slice(0, startpos) + compare.slice(startpos + text.length)\n                        })\n                    }\n\n                    let mark = cm.setBookmark(cm.posFromIndex(choffset), {\n                        widget: thing\n                    })\n                    mark.__diff = true;\n                    cmpoffset += text.length;\n\n                }else if(type > 0){ // insert\n                    let thing = document.createElement('span')\n                    thing.className = 'inserted'\n                    thing.innerText = text;\n                    let startpos = cmpoffset;\n\n                    thing.onclick = () => {\n                        console.log('insert!', text)\n\n                        this.props.compareCommit({\n                            text: compare.slice(0, startpos) + text + compare.slice(startpos)\n                        })\n                    }\n\n                    let mark = cm.markText(cm.posFromIndex(choffset), cm.posFromIndex(choffset + text.length), {\n                        replacedWith: thing\n                    })\n                    mark.__diff = true;\n\n                    choffset += text.length;\n\n                    \n                }else{\n                    choffset += text.length;\n                    cmpoffset += text.length;\n                }\n            }\n\n        }\n    }\n    componentDidUpdate(){\n        if(!this.cm.curOp && this.props.state.data !== this.cm.getValue()){\n            // var selections = this.cm.listSelections()\n            this.cm.setValue(this.props.state.data)\n            try {\n                this.cm.setSelections(this.props.state.selections.map(([anchor, head]) => ({\n                    anchor: this.cm.posFromIndex(anchor),\n                    head: this.cm.posFromIndex(head)\n                })))\n            } catch (err) {}\n        }\n        this.updateDiff()\n    }\n    render(){ \n        return <div className=\"widget\">\n            <div className=\"editor\" />\n        </div> \n    }\n}\n\n\nexport function reduce(prev, delta){\n    if(!prev) return { version: 0, data: '', selections: [] };\n\n    return {\n        version: prev.version + 1,\n        data: delta.text,\n        selections: delta.selections || prev.selections\n    }\n}\n\n// export default function Widget(props){\n//     var state = props.state;\n//     if(!state){\n//         return <div>(no state)</div>\n//     }\n//     return <div className=\"widget\">\n//             <CodeEditor \n//                 value={state.data}\n                \n//                 undo={props.undo} \n//                 redo={props.redo}\n//                 fork={props.fork}\n//                 setMessage={props.setMessage}\n//                 save={props.save}\n\n//                 compare={props.compare && props.compare.data}\n//                 onChange={text => props.commit({ text: text })} />\n//     </div>\n// }","\nvar childStore = null,\n    childMapping = {};\n\n\nexport function getChildren(store, id){\n    if(store !== childStore){\n        childStore = store;\n        childMapping = {}\n        for(var k in store){\n            var parent = store[k].parent;\n            if(!childMapping[parent]){\n                childMapping[parent] = [k];\n            }else{\n                childMapping[parent].push(k)\n            }\n        }\n    }\n    return childMapping[id] || [];\n}\n\n\n\n\nexport function getState(reduceFn, store, id){\n    var commit = store[id];\n    if(!commit) return reduceFn(null, null);\n    return reduceFn(getState(reduceFn, store, commit.parent), commit.delta);\n}\n\nexport function getPath(store, id){\n    var commit = store[id];\n    if(!commit) return [null];\n    return getPath(store, commit.parent).concat([id])\n}\n\n\n\nexport function computeAnchor(store, id){\n    var children = getChildren.bind(this, store)\n    var node = id;\n    var ch = children(node);\n    while(ch.length > 0){\n        node = ch[0]\n        ch = children(node)\n    }\n    return node;\n}\n\nexport function getCurrentChunk(store, id, views, messages){\n    var children = getChildren.bind(this, store)\n    var node = id;\n    var ch = children(node);\n\n    while(ch.length === 1 \n        && node \n        // && !views.some(k => k.anchor == node)\n        && !(messages[node])\n        ){\n        node = ch[0]\n        // trail.push(node)\n        ch = children(node)\n    }\n    return node;\n}\n","// why did i name this bread\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport ReactCSSTransitionGroup from 'react-addons-css-transition-group' // ES6\nimport FlipMove from 'react-flip-move';\n\nimport './bread.css';\nimport 'font-awesome/css/font-awesome.css';\n\n\n\nfunction sqr(x) { return x * x }\nfunction dist2(v, w) { return sqr(v.x - w.x) + sqr(v.y - w.y) }\nfunction distToSegmentSquared(p, v, w) {\n  var l2 = dist2(v, w);\n  if (l2 == 0) return dist2(p, v);\n  var t = ((p.x - v.x) * (w.x - v.x) + (p.y - v.y) * (w.y - v.y)) / l2;\n  t = Math.max(0, Math.min(1, t));\n  return dist2(p, { x: v.x + t * (w.x - v.x),\n                    y: v.y + t * (w.y - v.y) });\n}\nfunction distToSegment(p, v, w) { return Math.sqrt(distToSegmentSquared(p, v, w)); }\n\nfunction uuid(){\n\treturn Math.random().toString(36).slice(5, 10)\n}\n\n\nexport default class Bread extends React.Component {\n\tconstructor(){\n\t\tsuper()\n\t\tthis.state = { dragThing: null }\n\t\tthis.mouseMove = this.mouseMove.bind(this)\n\t\tthis.mouseUp = this.mouseUp.bind(this)\n\t}\n\tbeginDrag(thing, e){\n\t\t// console.log('begin drag', thing, e)\n\t\tthis.setState({\n\t\t\tdragThing: thing\n\t\t})\n\t\twindow.addEventListener('mousemove', this.mouseMove)\n\t\twindow.addEventListener('mouseup', this.mouseUp)\n\t}\n\tmouseMove(e){\n\t\tif(this.state.dragThing){\n\t\t\te.preventDefault()\n\t\t}\n\t\tvar clientY = e.clientY;\n\t\tvar el = ReactDOM.findDOMNode(this);\n\t\tvar rows = el.querySelectorAll('.row');\n\t\tvar thingRect;\n\n\t\tvar lines = []\n\t\tfor(var i = 0; i < rows.length; i++){\n\t\t\tvar rect = rows[i].getBoundingClientRect()\n\t\t\tif(i === 0){\n\t\t\t\tlines.push({\n\t\t\t\t\tx0: rect.left, x1: rect.right,\n\t\t\t\t\ty0: rect.top, y1: rect.top,\n\t\t\t\t\tpos: 'top-' + i\n\t\t\t\t})\n\t\t\t}\n\t\t\tlines.push({\n\t\t\t\tx0: rect.left, x1: rect.right,\n\t\t\t\ty0: rect.bottom, y1: rect.bottom,\n\t\t\t\tpos: 'bottom-' + i\n\t\t\t})\n\n\t\t\tvar slices = rows[i].querySelectorAll('.slice');\n\t\t\tfor(var j = 0; j < slices.length; j++){\n\t\t\t\tvar rect = slices[j].getBoundingClientRect()\n\t\t\t\tif(j === 0){\n\t\t\t\t\tlines.push({\n\t\t\t\t\t\tx0: rect.left, x1: rect.left,\n\t\t\t\t\t\ty0: rect.top, y1: rect.bottom,\n\t\t\t\t\t\tpos: 'left-' + i + '-' + j\n\t\t\t\t\t})\t\n\t\t\t\t}\n\t\t\t\tlines.push({\n\t\t\t\t\tx0: rect.right, x1: rect.right,\n\t\t\t\t\ty0: rect.top, y1: rect.bottom,\n\t\t\t\t\tpos: 'right-' + i + '-' + j\n\t\t\t\t})\n\n\t\t\t\tif(this.state.dragThing == i + '-' + j){\n\t\t\t\t\tthingRect = rect;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t\n\n\n\t\tlines.forEach(k => {\n\t\t\tk.dist = distToSegment(\n\t\t\t\t{ x: e.clientX, y: e.clientY }, \n\t\t\t\t{ x: k.x0, y: k.y0 }, \n\t\t\t\t{ x: k.x1, y: k.y1 })\n\t\t})\n\n\t\tvar closestPos = lines.sort((a, b) => a.dist - b.dist)[0].pos\n\t\tvar thing = this.state.dragThing.split('-');\n\n\t\tif(e.clientX > thingRect.left && e.clientX < thingRect.right\n\t\t\t&& e.clientY > thingRect.top && e.clientY < thingRect.bottom){\n\n\t\t\tclosestPos = (+thing[1] == 0) ? \n\t\t\t\t('left-' + thing.join('-')) : \n\t\t\t\t('right-' + [thing[0], thing[1] - 1].join('-'))\n\t\t}\n\t\t// console.log(closestPos.pos)\n\n\n\t\t// console.log(i)\n\t\tif(this.state.dockTarget !== i){\n\t\t\tthis.setState({\n\t\t\t\tdockTarget: closestPos\n\t\t\t})\t\n\t\t}\n\t\t\n\t\t// console.log('moving', e, )\n\t}\n\tcloneLayout(){\n\t\treturn {\n\t\t\trows: this.props.layout.rows.map(row => {\n\t\t\t\treturn { id: row.id, elements: row.elements.slice(0) }\n\t\t\t})\n\t\t}\n\t}\n\tmouseUp(e){\n\t\t\n\t\tif(this.state.dockTarget){\n\t\t\tvar pos = this.state.dockTarget.split('-');\n\t\t\tvar thing = this.state.dragThing.split('-');\n\n\t\t\tvar nextRows = this.cloneLayout().rows;\n\t\t\t\n\n\t\t\tif(pos[0] === 'top' || pos[0] === 'bottom'){\n\t\t\t\tif((nextRows[+thing[0]].elements.length == 1) &&\n\t\t\t\t\t((pos[0] === 'top'  && +thing[0] === +pos[1]) || \n\t\t\t\t\t(pos[0] === 'bottom' && +thing[0] === parseInt(pos[1])+1) ||\n\t\t\t\t\t(pos[0] === 'bottom' && +thing[0] === +pos[1]) )\n\t\t\t\t){\n\t\t\t\t}else{\n\t\t\t\t\tvar oldThing = nextRows[+thing[0]].elements.splice(+thing[1], 1)[0];\n\t\t\t\t\tvar newRow = { id: uuid(), elements: [ oldThing ] }\n\t\t\t\t\tif(pos[0] === 'top'){\n\t\t\t\t\t\tnextRows.splice(+pos[1], 0, newRow)\n\t\t\t\t\t}else{\n\t\t\t\t\t\tnextRows.splice(1 + parseInt(pos[1]), 0, newRow)\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t}else if(pos[0] === 'left' || pos[0] === 'right'){\n\t\t\t\t// swap it with null\n\t\t\t\tvar oldThing = nextRows[+thing[0]].elements.splice(+thing[1], 1, null)[0];\n\n\t\t\t\tif(pos[0] === 'left'){\n\t\t\t\t\tnextRows[+pos[1]].elements.splice(+pos[2], 0, oldThing)\n\t\t\t\t}else{\n\t\t\t\t\tnextRows[+pos[1]].elements.splice(1 +parseInt(pos[2]), 0, oldThing)\n\t\t\t\t}\n\t\t\t\t// actually remove the thing\n\t\t\t\tnextRows[+thing[0]].elements = nextRows[+thing[0]].elements.filter(k => k !== null)\n\n\t\t\t}\n\n\t\t\tnextRows = nextRows.filter(k => k.elements.length > 0)\n\n\t\t\tthis.props.updateLayout({ rows: nextRows })\n\t\t}\n\n\n\n\t\tthis.setState({\n\t\t\tdragThing: null,\n\t\t\tdockTarget: null\n\t\t})\n\n\t\twindow.removeEventListener('mousemove', this.mouseMove)\n\t\twindow.removeEventListener('mouseup', this.mouseUp)\n\t}\n\n\trender(){\n\t\tvar Slice = this.props.Slice;\n\t\treturn <div className=\"bread\" style={{ cursor: this.state.dragThing ? 'move' : 'default' }}>\n\t\t<FlipMove>\n\t\t{this.props.layout.rows.map((row, rowi) => \n\t\t\t<div className={\"row \" + (\n\t\t\t\t(this.state.dockTarget === ('top-' + rowi) ? 'insert-top ' : '') +\n\t\t\t\t(this.state.dockTarget === ('bottom-' + rowi) ? 'insert-bottom ' : '') +\n\t\t\t\t('row-' + row.elements.length + ' ')\n\t\t\t)} key={row.id}>\n\t\t\t<ReactCSSTransitionGroup\n\t          transitionName=\"example\"\n\t          transitionEnterTimeout={300}\n\t          transitionLeaveTimeout={300}>\n\n\t\t\t{row.elements.map((data, coli) => \n\t\t\t\t<div className={\"col \" + (\n\t\t\t\t\t(this.state.dockTarget === ('left-' + rowi + '-' + coli) ? 'insert-left ' : '') +\n\t\t\t\t\t(this.state.dockTarget === ('right-' + rowi + '-' + coli) ? 'insert-right ' : '')\n\t\t\t\t)} key={data.id}>\n\t\t\t\t\t<Slice view={data} \n\t\t\t\t\tisDragging={this.state.dragThing === [rowi, coli].join('-')}\n\t\t\t\t\tgetView={id => {\n\t\t\t\t\t\tvar result;\n\t\t\t\t\t\tthis.props.layout.rows.forEach(row => row.elements.forEach(data => {\n\t\t\t\t\t\t\tif(data.id == id) result = data;\n\t\t\t\t\t\t}))\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}}\n\t\t\t\t\tupdateView={(id, e) => {\n\t\t\t\t\t\tvar newRows = this.props.layout.rows.map(row => {\n\t\t\t\t\t\t\treturn Object.assign(row, { elements: row.elements.map(data => {\n\t\t\t\t\t\t\t\treturn (data.id == id) ? Object.assign({}, data, e) : data\n\t\t\t\t\t\t\t}) })\n\t\t\t\t\t\t})\n\t\t\t\t\t\tthis.props.updateLayout({ rows: newRows })\n\t\t\t\t\t}}\n\t\t\t\t\tfork={e => {\n\t\t\t\t\t\tvar newRows = this.cloneLayout().rows;\n\t\t\t\t\t\tnewRows[rowi].elements.splice(coli + 1, 0, Object.assign({}, data, { id: uuid() }, e || {}) )\n\t\t\t\t\t\tthis.props.updateLayout({ rows: newRows })\n\t\t\t\t\t}}\n\t\t\t\t\tupdate={e => {\n\t\t\t\t\t\tvar newRows = this.cloneLayout().rows;\n\t\t\t\t\t\tnewRows[rowi].elements[coli] = Object.assign({}, data, e)\n\t\t\t\t\t\tthis.props.updateLayout({ rows: newRows })\n\t\t\t\t\t}}\n\t\t\t\t\tclose={e => {\n\t\t\t\t\t\tvar newRows = this.cloneLayout().rows;\n\t\t\t\t\t\tnewRows[rowi].elements.splice(coli, 1)\n\t\t\t\t\t\tthis.props.updateLayout({ rows: newRows.filter(k => k.elements.length > 0) })\n\t\t\t\t\t}}\n\t\t\t\t\tbeginDrag={\n\t\t\t\t\t\te => this.beginDrag([rowi, coli].join('-'), e)\n\t\t\t\t\t} \n\t\t\t\t\t{...this.props} />\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\t</ReactCSSTransitionGroup>\n\t\t\t</div>\n\t\t)}\n\n\t\t<div className=\"fake-row row-1\" onClick={e => \n\t\t\tthis.props.updateLayout({ rows: \n\t\t\t\tthis.props.layout.rows.concat([{ id: uuid(), elements: [{ id: uuid() }] }])\n\t\t\t})}>\n\t\t\t<span>\n\t\t\t\t<div className=\"col\">\n\t\t\t\t\t<div className=\"fake-slice\">+</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t</div>\n\n\t\t</FlipMove>\n\t\t</div>\n\t}\n}\n\n\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { getPath, getChildren } from './util'\n\nvar textNode = document.createElementNS(\"http://www.w3.org/2000/svg\",\"text\");\nvar svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsvg.setAttribute('class', 'measure')\nsvg.setAttributeNS(\"http://www.w3.org/2000/xmlns/\", \"xmlns:xlink\", \"http://www.w3.org/1999/xlink\");\ndocument.body.appendChild(svg);\nsvg.appendChild(textNode)\n\nfunction measureText(text){\n    if(!text.trim()) return 0;\n    textNode.textContent = text;\n    return textNode.getComputedTextLength();\n}\n\n\nexport default function DAG(props){\n    var store = props.store,\n        view = props.view,\n        messages = props.messages;\n\n    const v_spacing = 25;\n    const v_height = 20;\n\n    const h_spacing = 10;\n\n    var children = getChildren.bind(this, store)\n    var path = getPath(store, view.anchor);\n\n    var elements = [],\n        lines = [];\n\n    function recursive(node, x, y){\n        var ch = children(node);\n        var trail = [node]\n        while(ch.length === 1 \n            && node \n            && !(props.messages[node])\n        ){\n            node = ch[0]\n            trail.push(node)\n            ch = children(node)\n        }\n\n        if(!node){\n\n        }else{\n            // console.log(trail.includes(view.pointer))\n            var rect_width = 10 * Math.sqrt(trail.length + 1)\n\n            var label = messages[node] || '';\n\n            rect_width = Math.max(rect_width, 5 + measureText(label))\n        \n            elements.push(<rect \n                key={'r-' + node}\n                x={x} y={y - v_height/2} \n                rx={2} ry={2}\n                width={rect_width} height={v_height} className={trail.includes(view.pointer) ? 'active' : (\n                    path.includes(node) ? 'mainline' : 'inactive') }\n                onClick={e => props.setPointer(node, e.metaKey || e.altKey || e.shiftKey || e.ctrlKey)}/>);\n\n            if(trail.includes(view.pointer) && trail.length > 0){\n                var trailIndex = trail.indexOf(view.pointer),\n                    eps = 0.001;\n                elements.push(<circle \n                    key={'c-' + node}\n                    cx={x + rect_width * ((trailIndex + eps) / (trail.length - 1 + eps) )} \n                    cy={y} r={3} className=\"active\" />)\n            }\n\n            elements.push(<text key={'t-'+node} x={2+x} y={y}>{label}</text>)\n\n            x += rect_width;\n        }\n\n        var y1 = y;\n        for(var i = 0; i < ch.length; i++){\n            var child = ch[i]\n            if(i > 0) y1 += v_spacing;\n\n            // if(node) lines.push(<line \n            //     x1={x} y1={y} \n            //     x2={x + h_spacing} y2={y1}\n            //     className={path.includes(child) ? 'mainline' : 'inactive'} />)\n\n            if(node) lines.push(<path \n                key={'p-' + child}\n                d={curvedHorizontal(x,y,x + h_spacing,y1)}\n                className={path.includes(child) ? 'mainline' : 'inactive'} />)\n            y1 = recursive(child, x + h_spacing, y1);\n            \n        }\n        return y1;\n    }\n\n    var height = 10 + recursive(null, -h_spacing, 10);\n    return <svg className=\"dag\" height={height}>{lines}{elements}</svg>\n}\n\n\n// https://github.com/hughsk/svg-line-curved/blob/master/index.js\nfunction curvedHorizontal(x1, y1, x2, y2) {\n    var line = []\n    var mx = x1 + (x2 - x1) / 2\n\n    line.push('M', x1, y1)\n    line.push('C', mx, y1, mx, y2, x2, y2)\n\n    return line.join(' ')\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n\nimport \"./app.css\"\nimport \"./dag.css\"\nimport Bread from './bread.js'\nimport Widget, { reduce } from './codemirror.js'\nimport DAG from './dag'\nimport { getCurrentChunk, computeAnchor, getChildren, getState, getPath } from './util'\n\n\n\n\n\nfunction Slice(props){\n    var pointer = props.view.pointer || null,\n        anchor = props.view.anchor || null;\n\n    var state = getState(reduce, props.store, pointer);\n    var path = getPath(props.store, anchor);\n    var pathIndex = path.indexOf(pointer);\n    var chunk = getCurrentChunk(props.store, pointer, props.views, props.messages);\n\n    var updatePointer = (id, shouldFork) => {\n        const applyUpdate = e => shouldFork ? props.fork(e) : props.update(e);\n        if(path.includes(id)){\n            applyUpdate({ pointer: id })    \n        }else{\n            applyUpdate({ pointer: id, anchor: computeAnchor(props.store, id) })\n        }\n    }\n\n    var commit = (delta) => {\n        var id = 'C' + Date.now();\n        props.appendStore(id, { \n            parent: pointer, \n            delta: delta,\n            date: Date.now()\n        })\n        updatePointer(id)\n    }\n\n    var fork = () => props.fork();\n\n    var save = () => {\n        if(!props.messages[props.view.pointer]){\n            props.setMessage(props.view.pointer, 'r' + pathIndex)\n        }\n    }\n\n\n    var compare;\n    if(props.viewIndex){\n        let view = props.getView(props.viewIndex)\n        compare = getState(reduce, props.store, view && view.pointer || null)\n    }\n\n    var compareCommit = (delta) => {\n        if(!compare) return;\n        let view = props.getView(props.viewIndex)\n\n        var id = 'C' + Date.now();\n        props.appendStore(id, { \n            parent: view && view.pointer || null, \n            delta: delta,\n            date: Date.now()\n        })\n        \n        props.updateView(props.viewIndex, {\n            pointer: id,\n            anchor: id\n        })\n    }\n\n    let title;\n    let widget;\n\n    return <div className={\"slice \" + (props.isDragging ? 'dragging ' : '') + (props.viewIndex == props.view.id ? 'reference ' : '')}>\n        <div className=\"header\" onMouseDown={props.beginDrag}>\n            <div className={\"button-toggle \" + (props.view.hideFooter?'inactive':'active')} \n                title=\"Toggle revision timeline\"\n                onClick={e => props.update({ hideFooter: !props.view.hideFooter })}>\n                {props.view.hideFooter ? \"▼\" : '▲'}</div>\n\n            <input \n                type=\"text\" \n                ref={e => title = e}\n                className=\"title\" value={props.messages[chunk] || ''} \n                placeholder={pointer == null ?  \"blank\" : \"no description\" }\n                disabled={pointer == null}\n                onChange={e => props.setMessage(chunk, e.target.value) } \n                onKeyDown={e => {\n                    if(e.keyCode === 13){\n                        e.preventDefault()\n                        widget.focus()\n                    }\n                }}/>\n\n            \n            <div className={\"button \" + (props.viewIndex == props.view.id ? 'active' : 'inactive')} \n                onClick={e => props.toggleFocus(props.view.id)}\n                title=\"Show differences relative to this version.\">\n                <i className=\"fa fa-bullseye\" aria-hidden=\"true\" /></div>\n\n            \n\n            <div className=\"button\" onClick={fork}\n                title=\"Fork this revision\">\n                <i className=\"fa fa-code-fork\" aria-hidden=\"true\" /></div>\n\n            <div className=\"button\" onClick={props.close}\n                title=\"Close this window\">\n                <i className=\"fa fa-close\" aria-hidden=\"true\" /></div>\n\n\n        \n        </div>\n\n        {props.view.hideFooter ? null : <div className=\"footer\"> \n            <input type=\"range\" className=\"time-slider\" min={0} max={path.length - 1} \n                disabled={path.length < 2}\n                onChange={e => updatePointer(path[e.target.value])}\n                value={path.indexOf(pointer)} />\n\n            <DAG \n                store={props.store} \n                view={props.view} \n                messages={props.messages}\n                views={props.views}\n                setPointer={updatePointer} />\n        </div>}\n        \n        <Widget\n            ref={e => widget = e}\n            setMessage={e => title.focus()}\n            undo={e => (pathIndex > 0) && updatePointer(path[pathIndex - 1])}\n            redo={e => (pathIndex < path.length - 1) && updatePointer(path[pathIndex + 1])}\n            fork={e => fork()}\n            save={e => save()}\n            compareCommit={compareCommit}\n            compare={compare}\n            state={state} \n            commit={commit} />\n        \n    </div>\n}\n\n\nconst DEFAULT_STATE = {\n    store: {\n    },\n    viewIndex: null,\n    messages: {\n        null: ''\n    },\n    layout: {\n        rows: []\n    }\n}\n\nclass App extends React.Component {\n    constructor(){\n        super()\n        try {\n            this.state = JSON.parse(localStorage.state)\n            console.log(this.state.layout.rows.length);\n        }catch(e){\n            this.state = JSON.parse(JSON.stringify(DEFAULT_STATE))\n        }\n        // window.onstorage = () => {\n        //     var latest = JSON.parse(localStorage.state);\n        //     if(JSON.stringify(latest.store) != JSON.stringify(this.state.store) ||\n        //         JSON.stringify(latest.messages) != JSON.stringify(this.state.messages)){\n        //         this.setState({ store: latest.store, messages: latest.messages })    \n        //     }\n        // }\n    }\n    componentDidUpdate(){\n        localStorage.state = JSON.stringify(this.state)\n    }\n\n    render(){\n        global.App = this;\n\n        return <div>\n            <div className=\"main-header\">\n                <h1>derp version control prototype</h1>\n\n                <div className=\"toolbar\">\n                    <div className=\"button\" onClick={e => {\n                        if(window.confirm('Are you sure you want to clear all history and start over? This can not be undone.')){\n                            localStorage.state = null\n                            this.setState(JSON.parse(JSON.stringify(DEFAULT_STATE)));    \n                        }\n                    }} title=\"Clear everything\">\n                        <i className=\"fa fa-trash\" aria-hidden=\"true\"></i></div>\n                </div>\n            </div>\n            <div className=\"main-header\">\n            <div>\n                <p>\n                \n                <b>Derp</b> is <b>version control</b> reimagined for <b>experimentation</b> and <b>live collaboration</b> in the internet age.\n                </p>\n                <p>\n\n                Rather than operating on files, it’s integrated into an application's state management system. \n\n                Coupled with a projectional window management system, you can create <b>lightweight forks</b> to try new ideas while referencing other versions. \n\n                Edits are synchronized character-by-character over the internet in <b>real-time</b>. \n\n                It blends the simplicity of <b>undo/redo</b> with the power and reliability of modern distributed version control systems like Git.\n\n                You never have to worry about losing data by a series of undos, redos, and edits. And you never have to worry about forgetting to commit code. \n\n                </p>\n                </div>\n            </div>\n            <Bread \n                Slice={Slice} \n                \n                layout={this.state.layout}\n                updateLayout={data => this.setState({ layout: data })}\n\n                store={this.state.store}\n                messages={this.state.messages}\n                viewIndex={this.state.viewIndex}\n\n                toggleFocus={id => this.setState({ viewIndex: this.state.viewIndex == id ? null : id })}\n                appendStore={(id, value) => this.setState({ store: \n                            Object.assign({}, this.state.store, { [id]: value }) })}\n                setMessage={(id, message) => this.setState({ messages: \n                            Object.assign({}, this.state.messages, { [id]: message })})} />\n        </div>    \n    }\n}\n\n\nReactDOM.render(\n    <App />,\n    document.getElementById('root')\n);\n"],"sourceRoot":""}